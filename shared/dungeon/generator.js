// Shared dungeon generator (CommonJS) usable by both server (require) and client (Vite can import CJS)
// TODO: Replace with real procedural generation using options (seed, size, theme, etc.)

// Default gameplay map (matches original server default)
function getDefaultMap() {
  return [
    '####################',
    '#.............~~~~~#',
    '#..####..####..~~~~#',
    '#..#  #..#  #..,.,.#',
    '#..#  +==+  #......#',
    '#..####..####......#',
    '#..................#',
    '####################',
  ].join('\n');
}

// Variant maps for non-gameplay backgrounds (login/lobby). Keeping here ensures single source of truth.
function getLoginBackgroundMap() {
  return [
    '############################################################',
    '#..........######.................######.............^.....#',
    '#..........#....#.................#....#...................#',
    '#..........#....#.....@@@@@.......#....#...................#',
    '#..........######.................######...................#',
    '#..........................................................#',
    '#.............######....................######.............#',
    '#.............#....#....................#....#.............#',
    '#.....@.......#....#....................#....#.......@.....#',
    '#.............######....................######.............#',
    '#..........................................................#',
    '############################################################',
  ].join('\n');
}

function getLobbyBackgroundMap() {
  return [
    '##############################|#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################@#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################|#############################',
    '##############################^#############################',
    '##############################|#############################',
  ].join('\n');
}

function generateDungeon(options = {}) {
  const variant = (options && options.variant) || '';
  if (variant === 'login') return getLoginBackgroundMap();
  if (variant === 'lobby') return getLobbyBackgroundMap();
  // Default gameplay map
  return getDefaultMap();
}

module.exports = { generateDungeon, getDefaultMap, getLoginBackgroundMap, getLobbyBackgroundMap };
